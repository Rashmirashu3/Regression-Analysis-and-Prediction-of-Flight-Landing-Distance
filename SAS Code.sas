/*IMPORTING THE DATASET FAA1*/

PROC IMPORT DATAFILE="/folders/myshortcuts/Stat_computing/Week3/FAA1.xls" 
	DBMS=XLS 
	OUT=FAA1;
	SHEET="FAA1";
RUN;
PROC PRINT DATA=FAA1; RUN;

/*****IMPORTING THE DATASET FAA2*****/

PROC IMPORT DATAFILE="/folders/myshortcuts/Stat_computing/Week3/FAA2.xls" 
	DBMS=XLS 
	OUT=FAA2;
	SHEET="FAA2";
RUN;

/*1. COMBINING DATASETS*/

DATA FAA1 ;
SET FAA1 ;

test=SUM(SPEED_AIR,SPEED_GROUND);
RUN;

data work.sales;
do year = 1 to 5;
do month = 1 to 12;

x+ 1; OUTPUT;
end;
end;
run;

How many

PROC PRINT DATA=FAA1; VAR  HEIGHT AIRCRAFT; SUM PITCH;RUN;
DATA FAA2 ;
SET FAA2 (RENAME=TEST1=TEST);
length test $12.;
test="test";
RUN;

proc contents data = WORK._all_; run;
proc sort data=faa1; by DESCENDING aircraft; run;
proc sort data=faa2; by DESCENDING aircraft; run;


data work.sales;
do year = 1 to 5;
do month=1 to 12;
Y+1;
output;
end;
end;
run;


data subset;
set FAA;
LENGTH AIRCRAFT $100;
AIRCRAFT="JJJ";
run;

DATA FAA ;
MERGE FAA1 FAA2;
BY DESCENDING AIRCRAFT;
RUN;

footnote 1 ‘Sales Report for Last Month’;
footnote2 ‘Selected Products Only’;
footnote3 ‘All Regions’;
footnote4 ‘All Figures in Thousands of Dollars’;

proc print data = FAA;
VAR AIRCRAFT;
SUM HEIGHT;
run;
data one;
address1 = "214 London Way";
run;
data one;
set one;
address = tranwrd(address1, 'Way', 'Drive'); run;

data work.sets;
do until (prod gt 6);
prod + 1;
end;
run;
PROC PRINT DATA=FAA1; RUN;

/* REMOVE DUPLICATES*/

PROC SORT DATA=FAA  OUT = FAA_NO_DUP NODUPKEY DUPOUT=DUPS;BY AIRCRAFT NO_PASG SPEED_GROUND SPEED_AIR HEIGHT PITCH DISTANCE; RUN;

/*2. EXAMINE IF MISSING VALUES ARE PRESENT*/

/*Proc means for airbus and boeing STATS for mean of duration speed*/

PROC MEANS DATA= FAA_NO_DUP N NMISS MEAN MIN MAX MEDIAN STD STDDEV;
VAR _NUMERIC_;
OUTPUT OUT=FAA_CLEAN;
RUN;

/*STATISTICS*/
PROC UNIVARIATE DATA=FAA_NO_DUP NORMAL;
HISTOGRAM/NORMAL;
RUN;

/*4. CLEANING THE DATA BASED ON THE RESULTS OF STEPS 2 AND 3; */

/*******ABNORMAL VALUES BASED ON THE VALIDITY RULES GIVEN******/

/*IF SPEED_GROUND VALUE IS LESS THAN 30MPH OR GREATER THAN 140MPH*
/*IF DURATION OF FLIGHT IS LESS THAN 40 MINUTES*
/*IF HEIGHT OF FLIGHT ON RUNWAY IS LESS THAN 6 FEET*
/*IF RUNWAY DISTANCE IS LESS THAN 6000*/

DATA FAA_CLEAN;
SET FAA_NO_DUP;
IF  DURATION LT 40 AND DURATION NE . THEN ABNORMALITY="DURATION LESS THAN 40 MINUTES" ;
ELSE IF (SPEED_GROUND LT 30 OR SPEED_GROUND GT 140) AND (SPEED_GROUND NE .) THEN ABNORMALITY="SPEED WRT GROUND IS NOT BETWEEN 30-140 MPH";
ELSE IF (SPEED_AIR LT 30 OR SPEED_AIR GT 140) AND (SPEED_AIR NE .) THEN ABNORMALITY="SPEED WRT GROUND IS NOT BETWEEN 30-140 MPH";
ELSE IF HEIGHT LT 6 THEN ABNORMALITY="HEIGHT IS LESS THAN 6 FT";
ELSE IF DISTANCE GT 6000 THEN ABNORMALITY="LANDING DISTANCE LESS THAN 6000";
ELSE ABNORMALITY="NONE";
RUN;

DATA FAA_ABNORMAL FAA_NORMAL;
SET FAA_CLEAN;
IF ABNORMALITY="NONE" THEN OUTPUT FAA_NORMAL;
ELSE OUTPUT FAA_ABNORMAL;
RUN;

proc print data=faa_abnormal; run;

/*5. SUMMARIZING THE DISTRIBUTION OF EACH VARIABLE (WHAT TABLES AND FIGURES WILL YOU PRESENT?) */


PROC UNIVARIATE DATA=FAA_NORMAL;
HISTOGRAM/NORMAL;
QQPLOT;
RUN;


/*Duration trend*/

proc sgplot data=FAA_NORMAL;
	vbox duration/;
	yaxis grid;
run;

/*Height trend*/

proc sgplot data=FAA_NORMAL;
	vbox height/;
	yaxis grid;
run;

/*No_pasg trend*/

proc sgplot data=FAA_NORMAL;
	vbox no_pasg/;
	yaxis grid;
run;

/*Speed_ground trend*/

proc sgplot data=FAA_NORMAL;
	vbox speed_ground/;
	yaxis grid;
run;

/*Pitch trend*/

proc sgplot data=FAA_NORMAL;
	vbox pitch/;
	yaxis grid;
run;

/*Distance trend*/

proc sgplot data=FAA_NORMAL;
	vbox distance/;
	yaxis grid;
run;


PROC SGSCATTER DATA=FAA_NORMAL; 
PLOT DISTANCE*(AIRCRAFT NO_PASG SPEED_GROUND SPEED_AIR HEIGHT PITCH); 
RUN;  

DATA FAA_NORMAL1;
SET FAA_NORMAL;
SPEED_GROUND1=SPEED_GROUND**2;
RUN;

PROC SGSCATTER DATA=FAA_NORMAL1; 
PLOT DISTANCE*(SPEED_GROUND1); 
RUN;  

DATA FAA_FINAL;
SET FAA_NORMAL1;
IF COMPRESS(UPCASE(AIRCRAFT))="BOEING" THEN AIRCRAFT_TYPE=1;
ELSE AIRCRAFT_TYPE=0;
RUN;

PROC CORR DATA=FAA_FINAL;
VAR AIRCRAFT_TYPE DURATION NO_PASG SPEED_GROUND SPEED_GROUND1 SPEED_AIR HEIGHT PITCH DISTANCE;
RUN;

DATA FAA_FIN2(DROP=SPEED_AIR);
SET FAA_FINAL;
RUN;

PROC REG DATA=FAA_FIN2;
MODEL DISTANCE= DURATION AIRCRAFT_TYPE SPEED_GROUND1 HEIGHT PITCH/r spec;
output out = FAA_FIN3 R=RESIDUAL;
RUN;

/*STATISTICS*/
PROC UNIVARIATE DATA=FAA_FIN3 NORMAL;
HISTOGRAM/NORMAL;
VAR RESIDUAL;
RUN;

PROC GLM DATA=FAA_FIN3;
CLASS AIRCRAFT_TYPE;
MODEL DISTANCE = SPEED_GROUND1 HEIGHT PITCH;
RUN;

PROC TTEST DATA=FAA_FIN3;
VAR DISTANCE;
CLASS AIRCRAFT_TYPE;
RUN;

